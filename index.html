<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
         content="OptMark: Robust Multi-bit Diffusion Watermarking via Inference Time Optimization - A novel approach to secure image watermarking using diffusion models">
  <meta name="keywords" content="watermarking, diffusion models, computer vision, security, machine learning, inference time optimization">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>OptMark: Robust Multi-bit Diffusion Watermarking via Inference Time Optimization</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/android-chrome-512x512.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu">
      <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      </div>
    </div>
  </nav>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">
              OptMark: Robust Multi-bit Diffusion Watermarking via Inference Time Optimization
            </h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="#" target="_blank">Jiazheng Xing</a><sup>1,2,*</sup>,</span>
              <span class="author-block">
                <a href="#" target="_blank">Hai Ci</a><sup>2,*</sup>,</span>
              <span class="author-block">
                <a href="#" target="_blank">Hongbin Xu</a><sup>2</sup>,</span>
              <span class="author-block">
                <a href="#" target="_blank">Hangjie Yuan</a><sup>1</sup>,</span>
              <span class="author-block">
                <a href="#" target="_blank">Yong Liu</a><sup>1,†</sup>,</span>
              <span class="author-block">
                <a href="#" target="_blank">Mike Zheng Shou</a><sup>2</sup></span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block"><sup>1</sup>Zhejiang University</span><br>
              <span class="author-block"><sup>2</sup>Show Lab, National University of Singapore</span><br>
              <span class="eql-cntrb"><small><sup>*</sup>Equal Contribution, <sup>†</sup>Corresponding Author</small></span>
            </div>
  


            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <span class="link-block">
                  <a href="#"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="#"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>

                <span class="link-block">
                  <a href="#"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <span class="link-block">
                  <a href="mailto:jiazhengxing@zju.edu.cn" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                          <i class="fas fa-envelope"></i>
                      </span>
                      <span>Contact</span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>



<!-- <section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <img src="static/images/case1.png" alt="ap-clip" />
        </div>
        <div class="item item-steve">
          <img src="static/images/case2.png" alt="ap-clip" />
        </div>
        <div class="item item-steve">
          <img src="static/images/case3.png" alt="ap-clip" />
        </div>
        <div class="item item-steve">
          <img src="static/images/case4.png" alt="ap-clip" />
        </div>
        <div class="item item-steve">
          <img src="static/images/case5.png" alt="ap-clip" />
        </div>
        <div class="item item-steve">
          <img src="static/images/case6.png" alt="ap-clip" />
        </div>
      </div>
    </div>
  </div>
</section> -->


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Watermarking diffusion-generated images is crucial for copyright protection and user tracking.
            However, current diffusion watermarking methods face significant limitations: zero-bit watermarking systems lack the capacity for large-scale user tracking, while multi-bit methods are highly sensitive to certain image transformations or generative attacks, resulting in a lack of comprehensive robustness.
            In this paper, we propose <strong>OptMark</strong>, an optimization-based approach that embeds a robust multi-bit watermark into the intermediate latents of the diffusion denoising process. OptMark strategically inserts a structural watermark early to resist generative attacks and a detail watermark late to withstand image transformations, with tailored regularization terms to preserve image quality and ensure imperceptibility.
            To address the challenge of memory consumption growing linearly with the number of denoising steps during optimization, OptMark incorporates adjoint gradient methods, reducing memory usage from O(N) to O(1). Experimental results demonstrate that OptMark achieves invisible multi-bit watermarking while ensuring robust resilience against valuemetric transformations, geometric transformations, editing, and regeneration attacks.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <section class="section">
      <div class="container is-max-desktop">
        <!-- Environment Infrastructure. -->
        <h2 class="title is-3 has-text-centered">Methods</h2>
        <div class="content has-text-justified">
          <img src="static/images/main.png" width="100%" alt="OptMark Method Overview" class="responsive-image">
          <md-block></md-block>The robust watermark is embedded into the diffusion latent space during the generation process through inference time optimization. In the Decoding phase, the watermark embedding is extracted using a pre-trained message decoder, and the secret message is retrieved by comparing the decoded watermark embedding against a predefined key carrier.</md-block>
        </div>
        <!--/ Environment Infrastructure. -->
      </div>
    </section>

    <section class="section">
      <div class="container is-max-desktop">
        <!-- Environment Infrastructure. -->
        <h2 class="title is-3 has-text-centered">Visualizations</h2>
        <div class="content has-text-justified">
          <img src="static/images/case_step2.png" width="100%" alt="" class="responsive-image">
          <img src="static/images/case_step3.png" width="100%" alt="" class="responsive-image">
          <img src="static/images/case_step4.png" width="100%" alt="" class="responsive-image">
          <img src="static/images/case_step5.png" width="100%" alt="" class="responsive-image">
          <!-- <img src="static/images/case_dall2.png" width="100%" alt="" class="responsive-image"> -->



        </div>
        <!--/ Environment Infrastructure. -->
      </div>
    </section>



  </div>
</section>



<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{xing2024optmark,
      title={OptMark: Robust Multi-bit Diffusion Watermarking via Inference Time Optimization},
      author={Xing, Jiazheng and Ci, Hai and Xu, Hongbin and Yuan, Hangjie and Liu, Yong and Shou, Mike Zheng},
      journal={arXiv preprint},
      year={2024}
    }</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>